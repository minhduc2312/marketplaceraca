{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\minhd\\\\Desktop\\\\marketplaceraca\\\\src\\\\components\\\\Sales.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport Table from '@mui/material/Table';\nimport { numberWithCommas } from './NFTs/PriceTable';\nimport axios from 'axios';\nimport { TextField, TableBody, TableCell, TableContainer, TableHead, TableRow, Paper, Button, CircularProgress } from '@mui/material';\nimport { initializeApp } from \"firebase/app\";\nimport firebaseConfig from \"../config\";\nimport { collection, getDocs, getFirestore, query, orderBy } from \"firebase/firestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction createData(name, totalSales, totalCost, totalWithdraw, percent) {\n  const sales = totalSales * percent / 100;\n  const cost = totalCost * percent / 100;\n  const profit = sales - cost;\n  const withdraw = totalWithdraw * percent / 100;\n  const remain = profit - withdraw;\n  return {\n    name,\n    sales,\n    cost,\n    profit,\n    withdraw,\n    remain\n  };\n}\n\nconst getHistory = (page, size) => {\n  return axios.get(`https://market-api.radiocaca.com/users/0x10201091597635eC7b8e208306E6aDCC7c167925/histories?pageNo=${page}&pageSize=${size}`);\n};\n\nconst Sales = () => {\n  _s();\n\n  const [listHistory, setListHistory] = useState([]);\n  const [listSummary, setListSummary] = useState([]);\n  const [listWithdraw, setListWithdraw] = useState([]);\n  const [toggle, setToggle] = useState(false);\n\n  const handleAddTrans = () => {\n    setToggle(prev => !prev);\n  };\n\n  useEffect(async () => {\n    let total = 0;\n    let currentPage = 1;\n    let listTemp = [];\n    let size = 10;\n\n    const fetchData = async () => {\n      do {\n        const response = await getHistory(currentPage, size);\n        currentPage++;\n        total = response.data.total;\n        listTemp = [...listTemp, ...response.data.list];\n      } while (listTemp.length < total);\n\n      setListHistory(listTemp);\n    };\n\n    fetchData();\n    const app = initializeApp(firebaseConfig);\n    const db = getFirestore(app);\n    const q = query(collection(db, \"Transaction\"), orderBy(\"time\"));\n    const querySnapshot = await getDocs(q);\n    const tempList = [];\n    querySnapshot.forEach(doc => {\n      tempList.push(doc.data());\n    });\n    const newList = tempList.map(item => {\n      return { ...item,\n        time: new Date(item.time.seconds * 1000).toLocaleString().split(',')[0]\n      };\n    });\n    setListWithdraw(newList);\n    return () => {\n      setListHistory([]);\n      setListWithdraw([]);\n    };\n  }, []);\n  useEffect(() => {\n    const listSales = listHistory.filter(item => item.nft_token_id === 407301);\n    const listCost = listHistory.filter(item => item.nft_token_id === 403545);\n    let sumSales = listSales.reduce((prev, curr) => {\n      return prev + (Number(curr.amount) - Number(curr.fee));\n    }, 0);\n    let sumCost = listCost.reduce((prev, curr) => {\n      return prev + Number(curr.amount);\n    }, 0);\n    let withdraw = 0;\n    let cost = 0;\n    listWithdraw.forEach((item, index) => {\n      if (item.transfer) {\n        withdraw += item.amount;\n        console.log(withdraw);\n      } else {\n        cost += item.amount;\n      }\n    }, 0);\n    sumCost += cost;\n    if (sumSales !== 0) sumSales -= 2700;\n    setListSummary([createData(\"Johny Duc\", sumSales, sumCost, withdraw, 40), createData(\"Khang Pug\", sumSales, sumCost, withdraw, 40), createData(\"Duc Professor\", sumSales, sumCost, withdraw, 20), createData(\"Total\", sumSales, sumCost, withdraw, 100)]);\n  }, [listHistory, listWithdraw]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"sales\",\n    children: [/*#__PURE__*/_jsxDEV(TableContainer, {\n      id: \"sales-section\",\n      component: Paper,\n      children: /*#__PURE__*/_jsxDEV(Table, {\n        sx: {\n          minWidth: 650\n        },\n        \"aria-label\": \"simple table\",\n        children: [/*#__PURE__*/_jsxDEV(TableHead, {\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              children: \"Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: \"Sales\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: \"Cost\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: \"Profit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: \"Withdraw\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: \"Remain\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n          children: [listHistory && listSummary && listSummary.map(row => /*#__PURE__*/_jsxDEV(TableRow, {\n            sx: {\n              '&:last-child td, &:last-child th': {\n                border: 0\n              }\n            },\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              component: \"th\",\n              scope: \"row\",\n              children: row.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: numberWithCommas(Math.floor(row.sales))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: numberWithCommas(Math.floor(row.cost))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: numberWithCommas(Math.floor(row.profit))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: numberWithCommas(Math.floor(row.withdraw))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              children: numberWithCommas(Math.floor(row.remain))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 33\n            }, this)]\n          }, row.name, true, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 29\n          }, this)), !listHistory && /*#__PURE__*/_jsxDEV(TableRow, {\n            sx: {\n              '&:last-child td, &:last-child th': {\n                border: 0\n              }\n            },\n            children: /*#__PURE__*/_jsxDEV(TableCell, {\n              component: \"th\",\n              scope: \"row\",\n              children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n                size: \"small\",\n                color: \"success\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 42\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"withdraw-history\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          textAlign: 'left'\n        },\n        children: \"Withdraw History\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"addTransaction\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          size: \"medium\",\n          id: \"toggleButton\",\n          onClick: handleAddTrans,\n          variant: \"contained\",\n          children: \"Add Transaction\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 21\n        }, this), toggle && /*#__PURE__*/_jsxDEV(React.StrictMode, {\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            type: \"number\",\n            label: \"Amount\",\n            variant: \"outlined\",\n            size: \"small\",\n            style: {\n              marginBottom: '10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            label: \"Notes\",\n            variant: \"outlined\",\n            size: \"small\",\n            id: \"notes\",\n            style: {\n              marginBottom: '10px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            id: \"addButton\",\n            size: \"medium\",\n            variant: \"contained\",\n            children: \"Add\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(TableContainer, {\n        id: \"withdraw\",\n        component: Paper,\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          sx: {\n            minWidth: 250\n          },\n          \"aria-label\": \"simple table\",\n          children: [/*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Time\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"center\",\n                children: \"Amount\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"center\",\n                children: \"Note\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n            children: listWithdraw && listWithdraw.map((row, index) => /*#__PURE__*/_jsxDEV(TableRow, {\n              sx: {\n                '&:last-child td, &:last-child th': {\n                  border: 0\n                }\n              },\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                component: \"th\",\n                scope: \"row\",\n                children: row.time\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 185,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"center\",\n                children: numberWithCommas(row.amount)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 188,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"center\",\n                children: numberWithCommas(row.notes)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 37\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 33\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Sales, \"fk9Zpz7T7RRsqFawQxE0xqZrfsc=\");\n\n_c = Sales;\nexport default Sales;\n\nvar _c;\n\n$RefreshReg$(_c, \"Sales\");","map":{"version":3,"sources":["C:/Users/minhd/Desktop/marketplaceraca/src/components/Sales.js"],"names":["React","useEffect","useState","Table","numberWithCommas","axios","TextField","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","Button","CircularProgress","initializeApp","firebaseConfig","collection","getDocs","getFirestore","query","orderBy","createData","name","totalSales","totalCost","totalWithdraw","percent","sales","cost","profit","withdraw","remain","getHistory","page","size","get","Sales","listHistory","setListHistory","listSummary","setListSummary","listWithdraw","setListWithdraw","toggle","setToggle","handleAddTrans","prev","total","currentPage","listTemp","fetchData","response","data","list","length","app","db","q","querySnapshot","tempList","forEach","doc","push","newList","map","item","time","Date","seconds","toLocaleString","split","listSales","filter","nft_token_id","listCost","sumSales","reduce","curr","Number","amount","fee","sumCost","index","transfer","console","log","minWidth","row","border","Math","floor","textAlign","marginBottom","notes"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport Table from '@mui/material/Table';\r\nimport { numberWithCommas } from './NFTs/PriceTable'\r\nimport axios from 'axios';\r\nimport { TextField, TableBody, TableCell, TableContainer, TableHead, TableRow, Paper, Button, CircularProgress } from '@mui/material';\r\nimport { initializeApp } from \"firebase/app\";\r\nimport firebaseConfig from \"../config\"\r\nimport { collection, getDocs, getFirestore, query, orderBy } from \"firebase/firestore\";\r\n\r\nfunction createData(name, totalSales, totalCost, totalWithdraw, percent) {\r\n    const sales = totalSales * percent / 100;\r\n    const cost = totalCost * percent / 100;\r\n    const profit = (sales - cost);\r\n    const withdraw = totalWithdraw * percent / 100;\r\n    const remain = profit - withdraw;\r\n    return { name, sales, cost, profit, withdraw, remain };\r\n}\r\n\r\nconst getHistory = (page, size) => {\r\n    return axios.get(`https://market-api.radiocaca.com/users/0x10201091597635eC7b8e208306E6aDCC7c167925/histories?pageNo=${page}&pageSize=${size}`);\r\n\r\n}\r\n\r\n\r\nconst Sales = () => {\r\n    const [listHistory, setListHistory] = useState([]);\r\n    const [listSummary, setListSummary] = useState([]);\r\n    const [listWithdraw, setListWithdraw] = useState([]);\r\n    const [toggle, setToggle] = useState(false);\r\n\r\n    const handleAddTrans = () => {\r\n        setToggle(prev => !prev)\r\n    }\r\n\r\n    useEffect(async () => {\r\n        let total = 0;\r\n        let currentPage = 1;\r\n        let listTemp = [];\r\n        let size = 10;\r\n        const fetchData = async () => {\r\n            do {\r\n                const response = await getHistory(currentPage, size)\r\n                currentPage++;\r\n                total = response.data.total;\r\n                listTemp = [...listTemp, ...response.data.list]\r\n            } while (listTemp.length < total)\r\n\r\n            setListHistory(listTemp)\r\n        }\r\n        fetchData();\r\n\r\n        const app = initializeApp(firebaseConfig);\r\n        const db = getFirestore(app);\r\n\r\n        const q = query(collection(db, \"Transaction\"), orderBy(\"time\"));\r\n        \r\n        const querySnapshot = await getDocs(q);\r\n        const tempList = [];\r\n        querySnapshot.forEach((doc) => {\r\n            tempList.push(doc.data());\r\n        });\r\n\r\n        const newList = tempList.map(item => {\r\n            return {\r\n                ...item,\r\n                time: new Date(item.time.seconds * 1000).toLocaleString().split(',')[0]\r\n\r\n            }\r\n        })\r\n        setListWithdraw(newList);\r\n        return () => {\r\n            setListHistory([])\r\n            setListWithdraw([])\r\n        }\r\n\r\n    }, [])\r\n    useEffect(() => {\r\n\r\n        const listSales = listHistory.filter(item => item.nft_token_id === 407301)\r\n        const listCost = listHistory.filter(item => item.nft_token_id === 403545)\r\n\r\n        let sumSales = listSales.reduce((prev, curr) => {\r\n            return prev + (Number(curr.amount) - Number(curr.fee))\r\n        }, 0);\r\n        let sumCost = listCost.reduce((prev, curr) => {\r\n            return prev + Number(curr.amount)\r\n        }, 0);\r\n\r\n        let withdraw = 0;\r\n        let cost = 0;\r\n        listWithdraw.forEach((item,index) => {\r\n            if (item.transfer) {\r\n                withdraw += item.amount;\r\n                console.log(withdraw)\r\n            } else {\r\n                cost += item.amount;\r\n            }\r\n        }, 0);\r\n        sumCost += cost;\r\n        if (sumSales !== 0)\r\n            sumSales -= 2700;\r\n        setListSummary([\r\n            createData(\"Johny Duc\", sumSales, sumCost, withdraw, 40),\r\n            createData(\"Khang Pug\", sumSales, sumCost, withdraw, 40),\r\n            createData(\"Duc Professor\", sumSales, sumCost, withdraw, 20),\r\n            createData(\"Total\", sumSales, sumCost, withdraw, 100),\r\n        ]);\r\n    }, [listHistory, listWithdraw])\r\n    return (\r\n        <div className=\"sales\">\r\n            <TableContainer id=\"sales-section\" component={Paper}>\r\n                <Table sx={{ minWidth: 650 }} aria-label=\"simple table\">\r\n                    <TableHead>\r\n                        <TableRow>\r\n                            <TableCell>Name</TableCell>\r\n                            <TableCell align=\"center\">Sales</TableCell>\r\n                            <TableCell align=\"center\">Cost</TableCell>\r\n                            <TableCell align=\"center\">Profit</TableCell>\r\n                            <TableCell align=\"center\">Withdraw</TableCell>\r\n                            <TableCell align=\"center\">Remain</TableCell>\r\n                        </TableRow>\r\n                    </TableHead>\r\n                    <TableBody>\r\n                        {listHistory && listSummary && listSummary.map((row) => (\r\n                            <TableRow\r\n                                key={row.name}\r\n                                sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\r\n                            >\r\n                                <TableCell component=\"th\" scope=\"row\">{row.name}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.sales))}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.cost))}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.profit))}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.withdraw))}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.remain))}</TableCell>\r\n                            </TableRow>\r\n                        ))}\r\n                        {!listHistory && <TableRow sx={{ '&:last-child td, &:last-child th': { border: 0 } }}>\r\n                            <TableCell component=\"th\" scope=\"row\">\r\n                                <CircularProgress size='small' color=\"success\" />\r\n                            </TableCell>\r\n                        </TableRow>}\r\n\r\n                    </TableBody>\r\n                </Table>\r\n            </TableContainer>\r\n            <div id=\"withdraw-history\">\r\n                <h2 style={{\r\n                    textAlign: 'left'\r\n                }}>Withdraw History</h2>\r\n                <div id=\"addTransaction\">\r\n                    <Button\r\n                        size=\"medium\"\r\n                        id=\"toggleButton\"\r\n                        onClick={handleAddTrans}\r\n                        variant=\"contained\" >Add Transaction</Button>\r\n                    {toggle && (\r\n                        <React.StrictMode>\r\n                            <TextField\r\n                                type='number'\r\n                                label=\"Amount\"\r\n                                variant=\"outlined\" size=\"small\"\r\n                                style={{ marginBottom: '10px' }} />\r\n                            <TextField\r\n                                label=\"Notes\" variant=\"outlined\" size=\"small\" id=\"notes\"\r\n                                style={{ marginBottom: '10px' }} />\r\n                            <Button id=\"addButton\" size=\"medium\" variant=\"contained\">Add</Button>\r\n                        </React.StrictMode>\r\n                    )}\r\n                </div>\r\n                <TableContainer id='withdraw' component={Paper}>\r\n                    <Table sx={{ minWidth: 250 }} aria-label=\"simple table\">\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Time</TableCell>\r\n                                <TableCell align=\"center\">Amount</TableCell>\r\n                                <TableCell align=\"center\">Note</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableBody>\r\n                            {listWithdraw && listWithdraw.map((row, index) => (\r\n                                <TableRow\r\n                                    key={index}\r\n                                    sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\r\n                                >\r\n                                    <TableCell component=\"th\" scope=\"row\">\r\n                                        {row.time}\r\n                                    </TableCell>\r\n                                    <TableCell align=\"center\">{numberWithCommas(row.amount)}</TableCell>\r\n                                    <TableCell align=\"center\">{numberWithCommas(row.notes)}</TableCell>\r\n\r\n                                </TableRow>\r\n                            ))}\r\n                        </TableBody>\r\n                    </Table>\r\n                </TableContainer>\r\n            </div>\r\n        </div>\r\n\r\n    );\r\n}\r\n\r\nexport default Sales;"]},"metadata":{},"sourceType":"module"}