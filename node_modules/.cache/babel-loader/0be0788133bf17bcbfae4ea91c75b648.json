{"ast":null,"code":"import _objectSpread from\"C:/Users/minhd/Desktop/marketplaceraca/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/minhd/Desktop/marketplaceraca/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"C:/Users/minhd/Desktop/marketplaceraca/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"C:/Users/minhd/Desktop/marketplaceraca/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/minhd/Desktop/marketplaceraca/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import Table from'@mui/material/Table';import{numberWithCommas}from'../NFTs/PriceTable';import axios from'axios';import{TextField,TableBody,TableCell,TableContainer,TableHead,TableRow,Paper,Button,CircularProgress}from'@mui/material';import{initializeApp}from\"firebase/app\";import firebaseConfig from\"../../config\";import{collection,getDocs,getFirestore,query,orderBy}from\"firebase/firestore\";import'../../styles/sales.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function createData(name,totalSales,totalCost,totalWithdraw,percent){var sales=totalSales*percent/100;var cost=totalCost*percent/100;var profit=sales-cost;var withdraw=totalWithdraw*percent/100;var remain=profit-withdraw;return{name:name,sales:sales,cost:cost,profit:profit,withdraw:withdraw,remain:remain};}var getHistory=function getHistory(page,size){return axios.get(\"https://market-api.radiocaca.com/users/0x10201091597635eC7b8e208306E6aDCC7c167925/histories?pageNo=\".concat(page,\"&pageSize=\").concat(size));};var Sales=function Sales(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),listHistory=_useState2[0],setListHistory=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),listSummary=_useState4[0],setListSummary=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),listWithdraw=_useState6[0],setListWithdraw=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),toggle=_useState8[0],setToggle=_useState8[1];var handleAddTrans=function handleAddTrans(){setToggle(function(prev){return!prev;});};useEffect(function(){var total=0;var currentPage=1;var listTemp=[];var size=10;var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getHistory(currentPage,size);case 2:response=_context.sent;currentPage++;total=response.data.total;listTemp=[].concat(_toConsumableArray(listTemp),_toConsumableArray(response.data.list));case 6:if(listTemp.length<total){_context.next=0;break;}case 7:setListHistory(listTemp);case 8:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();var getData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var app,db,q,querySnapshot,tempList,newList;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:app=initializeApp(firebaseConfig);db=getFirestore(app);q=query(collection(db,\"Transaction\"),orderBy(\"time\"));_context2.next=5;return getDocs(q);case 5:querySnapshot=_context2.sent;tempList=[];querySnapshot.forEach(function(doc){tempList.push(doc.data());});newList=tempList.map(function(item){return _objectSpread(_objectSpread({},item),{},{time:new Date(item.time.seconds*1000).toLocaleString().split(',')[0]});});setListWithdraw(newList);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function getData(){return _ref2.apply(this,arguments);};}();getData();return function(){setListHistory([]);setListWithdraw([]);};},[]);useEffect(function(){var listSales=listHistory.filter(function(item){return item.nft_token_id===407301;});var listCost=listHistory.filter(function(item){return item.nft_token_id===403545;});var sumSales=listSales.reduce(function(prev,curr){if(curr.time>Date.parse(\"12/28/2021\")/1000){curr.fee=Number(curr.amount)*5/100;}return prev+(Number(curr.amount)-Number(curr.fee));},0);var sumCost=listCost.reduce(function(prev,curr){return prev+Number(curr.amount);},0);var withdraw=0;var cost=0;listWithdraw.forEach(function(item,index){if(item.transfer){withdraw+=Number(item.amount);}else{cost+=Number(item.amount);}},0);sumCost+=cost;if(sumSales!==0)sumSales-=2700;setListSummary([createData(\"Johny Duc\",sumSales,sumCost,withdraw,40),createData(\"Khang Pug\",sumSales,sumCost,withdraw,40),createData(\"Duc Professor\",sumSales,sumCost,withdraw,20),createData(\"Total\",sumSales,sumCost,withdraw,100)]);},[listHistory,listWithdraw]);return/*#__PURE__*/_jsxs(\"div\",{className:\"sales\",children:[/*#__PURE__*/_jsx(TableContainer,{id:\"sales-section\",component:Paper,children:/*#__PURE__*/_jsxs(Table,{sx:{minWidth:650},\"aria-label\":\"simple table\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Name\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Sales\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Cost\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Profit\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Withdraw\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Remain\"})]})}),/*#__PURE__*/_jsxs(TableBody,{children:[listHistory&&listSummary&&listSummary.map(function(row){return/*#__PURE__*/_jsxs(TableRow,{sx:{'&:last-child td, &:last-child th':{border:0}},children:[/*#__PURE__*/_jsx(TableCell,{component:\"th\",scope:\"row\",children:row.name}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:numberWithCommas(Math.floor(row.sales))}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:numberWithCommas(Math.floor(row.cost))}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:numberWithCommas(Math.floor(row.profit))}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:numberWithCommas(Math.floor(row.withdraw))}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:numberWithCommas(Math.floor(row.remain))})]},row.name);}),!listHistory&&/*#__PURE__*/_jsx(TableRow,{sx:{'&:last-child td, &:last-child th':{border:0}},children:/*#__PURE__*/_jsx(TableCell,{component:\"th\",scope:\"row\",children:/*#__PURE__*/_jsx(CircularProgress,{size:\"small\",color:\"success\"})})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"withdraw-history\",children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:'left'},children:\"Withdraw History\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"addTransaction\",children:[/*#__PURE__*/_jsx(Button,{size:\"medium\",id:\"toggleButton\",onClick:handleAddTrans,variant:\"contained\",children:\"Add Transaction\"}),toggle&&/*#__PURE__*/_jsxs(React.StrictMode,{children:[/*#__PURE__*/_jsx(TextField,{type:\"number\",label:\"Amount\",variant:\"outlined\",size:\"small\",style:{marginBottom:'10px'}}),/*#__PURE__*/_jsx(TextField,{label:\"Notes\",variant:\"outlined\",size:\"small\",id:\"notes\",style:{marginBottom:'10px'}}),/*#__PURE__*/_jsx(Button,{id:\"addButton\",size:\"medium\",variant:\"contained\",children:\"Add\"})]})]}),/*#__PURE__*/_jsx(TableContainer,{id:\"withdraw\",component:Paper,children:/*#__PURE__*/_jsxs(Table,{sx:{minWidth:250},\"aria-label\":\"simple table\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Time\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Amount\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Note\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:listWithdraw&&listWithdraw.map(function(row,index){return/*#__PURE__*/_jsxs(TableRow,{sx:{'&:last-child td, &:last-child th':{border:0}},children:[/*#__PURE__*/_jsx(TableCell,{component:\"th\",scope:\"row\",children:row.time}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:numberWithCommas(row.amount)}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:numberWithCommas(row.notes)})]},index);})})]})})]})]});};export default Sales;","map":{"version":3,"sources":["C:/Users/minhd/Desktop/marketplaceraca/src/components/Sales/Sales.js"],"names":["React","useEffect","useState","Table","numberWithCommas","axios","TextField","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","Button","CircularProgress","initializeApp","firebaseConfig","collection","getDocs","getFirestore","query","orderBy","createData","name","totalSales","totalCost","totalWithdraw","percent","sales","cost","profit","withdraw","remain","getHistory","page","size","get","Sales","listHistory","setListHistory","listSummary","setListSummary","listWithdraw","setListWithdraw","toggle","setToggle","handleAddTrans","prev","total","currentPage","listTemp","fetchData","response","data","list","length","getData","app","db","q","querySnapshot","tempList","forEach","doc","push","newList","map","item","time","Date","seconds","toLocaleString","split","listSales","filter","nft_token_id","listCost","sumSales","reduce","curr","parse","fee","Number","amount","sumCost","index","transfer","minWidth","row","border","Math","floor","textAlign","marginBottom","notes"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport Table from '@mui/material/Table';\r\nimport { numberWithCommas } from '../NFTs/PriceTable'\r\nimport axios from 'axios';\r\nimport { TextField, TableBody, TableCell, TableContainer, TableHead, TableRow, Paper, Button, CircularProgress } from '@mui/material';\r\nimport { initializeApp } from \"firebase/app\";\r\nimport firebaseConfig from \"../../config\"\r\nimport { collection, getDocs, getFirestore, query, orderBy } from \"firebase/firestore\";\r\nimport '../../styles/sales.css';\r\n\r\n\r\nfunction createData(name, totalSales, totalCost, totalWithdraw, percent) {\r\n    const sales = totalSales * percent / 100;\r\n    const cost = totalCost * percent / 100;\r\n    const profit = (sales - cost);\r\n    const withdraw = totalWithdraw * percent / 100;\r\n    const remain = profit - withdraw;\r\n    return { name, sales, cost, profit, withdraw, remain };\r\n}\r\n\r\nconst getHistory = (page, size) => {\r\n    return axios.get(`https://market-api.radiocaca.com/users/0x10201091597635eC7b8e208306E6aDCC7c167925/histories?pageNo=${page}&pageSize=${size}`);\r\n\r\n}\r\n\r\n\r\nconst Sales = () => {\r\n    const [listHistory, setListHistory] = useState([]);\r\n    const [listSummary, setListSummary] = useState([]);\r\n    const [listWithdraw, setListWithdraw] = useState([]);\r\n    const [toggle, setToggle] = useState(false);\r\n\r\n    const handleAddTrans = () => {\r\n        setToggle(prev => !prev)\r\n    }\r\n\r\n    useEffect(() => {\r\n        let total = 0;\r\n        let currentPage = 1;\r\n        let listTemp = [];\r\n        let size = 10;\r\n        const fetchData = async () => {\r\n            do {\r\n                const response = await getHistory(currentPage, size)\r\n                currentPage++;\r\n                total = response.data.total;\r\n                listTemp = [...listTemp, ...response.data.list]\r\n            } while (listTemp.length < total)\r\n\r\n            setListHistory(listTemp)\r\n        }\r\n        fetchData();\r\n\r\n\r\n        const getData = async () => {\r\n            const app = initializeApp(firebaseConfig);\r\n            const db = getFirestore(app);\r\n\r\n            const q = query(collection(db, \"Transaction\"), orderBy(\"time\"));\r\n            const querySnapshot = await getDocs(q);\r\n            const tempList = [];\r\n            querySnapshot.forEach((doc) => {\r\n                tempList.push(doc.data());\r\n            });\r\n\r\n            const newList = tempList.map(item => {\r\n                return {\r\n                    ...item,\r\n                    time: new Date(item.time.seconds * 1000).toLocaleString().split(',')[0]\r\n\r\n                }\r\n            })\r\n            setListWithdraw(newList);\r\n        }\r\n        getData();\r\n        return () => {\r\n            setListHistory([])\r\n            setListWithdraw([])\r\n        }\r\n\r\n    }, [])\r\n    useEffect(() => {\r\n\r\n        const listSales = listHistory.filter(item => item.nft_token_id === 407301)\r\n        const listCost = listHistory.filter(item => item.nft_token_id === 403545)\r\n        let sumSales = listSales.reduce((prev, curr) => {\r\n            if (curr.time > Date.parse((\"12/28/2021\")) / 1000) {\r\n                curr.fee = Number(curr.amount) * 5 / 100;\r\n            }\r\n            return prev + (Number(curr.amount) - Number(curr.fee))\r\n        }, 0);\r\n        let sumCost = listCost.reduce((prev, curr) => {\r\n            return prev + Number(curr.amount)\r\n        }, 0);\r\n\r\n        let withdraw = 0;\r\n        let cost = 0;\r\n        listWithdraw.forEach((item, index) => {\r\n            if (item.transfer) {\r\n                withdraw += Number(item.amount);\r\n\r\n            } else {\r\n                cost += Number(item.amount);\r\n            }\r\n        }, 0);\r\n        sumCost += cost;\r\n        if (sumSales !== 0)\r\n            sumSales -= 2700;\r\n        setListSummary([\r\n            createData(\"Johny Duc\", sumSales, sumCost, withdraw, 40),\r\n            createData(\"Khang Pug\", sumSales, sumCost, withdraw, 40),\r\n            createData(\"Duc Professor\", sumSales, sumCost, withdraw, 20),\r\n            createData(\"Total\", sumSales, sumCost, withdraw, 100),\r\n        ]);\r\n    }, [listHistory, listWithdraw])\r\n    return (\r\n        <div className=\"sales\">\r\n            <TableContainer id=\"sales-section\" component={Paper}>\r\n                <Table sx={{ minWidth: 650 }} aria-label=\"simple table\">\r\n                    <TableHead>\r\n                        <TableRow>\r\n                            <TableCell>Name</TableCell>\r\n                            <TableCell align=\"center\">Sales</TableCell>\r\n                            <TableCell align=\"center\">Cost</TableCell>\r\n                            <TableCell align=\"center\">Profit</TableCell>\r\n                            <TableCell align=\"center\">Withdraw</TableCell>\r\n                            <TableCell align=\"center\">Remain</TableCell>\r\n                        </TableRow>\r\n                    </TableHead>\r\n                    <TableBody>\r\n                        {listHistory && listSummary && listSummary.map((row) => (\r\n                            <TableRow\r\n                                key={row.name}\r\n                                sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\r\n                            >\r\n                                <TableCell component=\"th\" scope=\"row\">{row.name}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.sales))}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.cost))}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.profit))}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.withdraw))}</TableCell>\r\n                                <TableCell align=\"center\">{numberWithCommas(Math.floor(row.remain))}</TableCell>\r\n                            </TableRow>\r\n                        ))}\r\n                        {!listHistory && <TableRow sx={{ '&:last-child td, &:last-child th': { border: 0 } }}>\r\n                            <TableCell component=\"th\" scope=\"row\">\r\n                                <CircularProgress size='small' color=\"success\" />\r\n                            </TableCell>\r\n                        </TableRow>}\r\n\r\n                    </TableBody>\r\n                </Table>\r\n            </TableContainer>\r\n            <div id=\"withdraw-history\">\r\n                <h2 style={{\r\n                    textAlign: 'left'\r\n                }}>Withdraw History</h2>\r\n                <div id=\"addTransaction\">\r\n                    <Button\r\n                        size=\"medium\"\r\n                        id=\"toggleButton\"\r\n                        onClick={handleAddTrans}\r\n                        variant=\"contained\" >Add Transaction</Button>\r\n                    {toggle && (\r\n                        <React.StrictMode>\r\n                            <TextField\r\n                                type='number'\r\n                                label=\"Amount\"\r\n                                variant=\"outlined\" size=\"small\"\r\n                                style={{ marginBottom: '10px' }} />\r\n                            <TextField\r\n                                label=\"Notes\" variant=\"outlined\" size=\"small\" id=\"notes\"\r\n                                style={{ marginBottom: '10px' }} />\r\n                            <Button id=\"addButton\" size=\"medium\" variant=\"contained\">Add</Button>\r\n                        </React.StrictMode>\r\n                    )}\r\n                </div>\r\n                <TableContainer id='withdraw' component={Paper}>\r\n                    <Table sx={{ minWidth: 250 }} aria-label=\"simple table\">\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell>Time</TableCell>\r\n                                <TableCell align=\"center\">Amount</TableCell>\r\n                                <TableCell align=\"center\">Note</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableBody>\r\n                            {listWithdraw && listWithdraw.map((row, index) => (\r\n                                <TableRow\r\n                                    key={index}\r\n                                    sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\r\n                                >\r\n                                    <TableCell component=\"th\" scope=\"row\">\r\n                                        {row.time}\r\n                                    </TableCell>\r\n                                    <TableCell align=\"center\">{numberWithCommas(row.amount)}</TableCell>\r\n                                    <TableCell align=\"center\">{numberWithCommas(row.notes)}</TableCell>\r\n\r\n                                </TableRow>\r\n                            ))}\r\n                        </TableBody>\r\n                    </Table>\r\n                </TableContainer>\r\n            </div>\r\n        </div>\r\n\r\n    );\r\n}\r\n\r\nexport default Sales;"]},"metadata":{},"sourceType":"module"}